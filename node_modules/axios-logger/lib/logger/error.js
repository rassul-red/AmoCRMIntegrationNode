"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.errorLogger = errorLogger;
exports.errorLoggerWithoutPromise = errorLoggerWithoutPromise;
var _config = require("../common/config");
var _stringBuilder = _interopRequireDefault(require("../common/string-builder"));
function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }
function errorLoggerWithoutPromise(error, config = {}) {
  if (!error.config) {
    return error;
  }
  const {
    config: {
      method,
      baseURL,
      params,
      url
    },
    response
  } = error;
  let status, statusText, data, headers;
  if (response) {
    status = response.status;
    statusText = response.statusText;
    data = response.data;
    headers = response.headers;
  }
  const buildConfig = (0, _config.assembleBuildConfig)(config);
  const stringBuilder = new _stringBuilder.default(buildConfig);
  const log = stringBuilder.makeLogTypeWithPrefix('Error').makeDateFormat(new Date()).makeMethod(method).makeUrl(url, baseURL).makeParams(params).makeStatus(status, statusText).makeHeader(headers).makeData(data) // TODO: fix type
  .build();
  buildConfig.logger(log);
  return error;
}
function errorLogger(error, config) {
  return Promise.reject(errorLoggerWithoutPromise(error, config));
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfY29uZmlnIiwicmVxdWlyZSIsIl9zdHJpbmdCdWlsZGVyIiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsIm9iaiIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiZXJyb3JMb2dnZXJXaXRob3V0UHJvbWlzZSIsImVycm9yIiwiY29uZmlnIiwibWV0aG9kIiwiYmFzZVVSTCIsInBhcmFtcyIsInVybCIsInJlc3BvbnNlIiwic3RhdHVzIiwic3RhdHVzVGV4dCIsImRhdGEiLCJoZWFkZXJzIiwiYnVpbGRDb25maWciLCJhc3NlbWJsZUJ1aWxkQ29uZmlnIiwic3RyaW5nQnVpbGRlciIsIlN0cmluZ0J1aWxkZXIiLCJsb2ciLCJtYWtlTG9nVHlwZVdpdGhQcmVmaXgiLCJtYWtlRGF0ZUZvcm1hdCIsIkRhdGUiLCJtYWtlTWV0aG9kIiwibWFrZVVybCIsIm1ha2VQYXJhbXMiLCJtYWtlU3RhdHVzIiwibWFrZUhlYWRlciIsIm1ha2VEYXRhIiwiYnVpbGQiLCJsb2dnZXIiLCJlcnJvckxvZ2dlciIsIlByb21pc2UiLCJyZWplY3QiXSwic291cmNlcyI6WyIuLi8uLi9zcmMvbG9nZ2VyL2Vycm9yLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEF4aW9zRXJyb3IgfSBmcm9tICdheGlvcyc7XG5pbXBvcnQgeyBFcnJvckxvZ0NvbmZpZyB9IGZyb20gJy4uL2NvbW1vbi90eXBlcyc7XG5pbXBvcnQgeyBhc3NlbWJsZUJ1aWxkQ29uZmlnIH0gZnJvbSAnLi4vY29tbW9uL2NvbmZpZyc7XG5pbXBvcnQgU3RyaW5nQnVpbGRlciBmcm9tICcuLi9jb21tb24vc3RyaW5nLWJ1aWxkZXInO1xuXG5mdW5jdGlvbiBlcnJvckxvZ2dlcldpdGhvdXRQcm9taXNlKGVycm9yOiBBeGlvc0Vycm9yLCBjb25maWc6IEVycm9yTG9nQ29uZmlnID0ge30pIHtcbiAgICBpZiAoIWVycm9yLmNvbmZpZykge1xuICAgICAgICByZXR1cm4gZXJyb3JcbiAgICB9XG5cbiAgICBjb25zdCB7Y29uZmlnOiB7IG1ldGhvZCwgYmFzZVVSTCwgcGFyYW1zLCB1cmwgfSwgcmVzcG9uc2V9ID0gZXJyb3I7XG5cbiAgICBsZXQgc3RhdHVzLCBzdGF0dXNUZXh0LCBkYXRhLCBoZWFkZXJzO1xuICAgIGlmIChyZXNwb25zZSkge1xuICAgICAgICBzdGF0dXMgPSByZXNwb25zZS5zdGF0dXM7XG4gICAgICAgIHN0YXR1c1RleHQgPSByZXNwb25zZS5zdGF0dXNUZXh0O1xuICAgICAgICBkYXRhID0gcmVzcG9uc2UuZGF0YTtcbiAgICAgICAgaGVhZGVycyA9IHJlc3BvbnNlLmhlYWRlcnM7XG4gICAgfVxuXG4gICAgY29uc3QgYnVpbGRDb25maWcgPSBhc3NlbWJsZUJ1aWxkQ29uZmlnKGNvbmZpZyk7XG5cbiAgICBjb25zdCBzdHJpbmdCdWlsZGVyID0gbmV3IFN0cmluZ0J1aWxkZXIoYnVpbGRDb25maWcpO1xuICAgIGNvbnN0IGxvZyA9IHN0cmluZ0J1aWxkZXJcbiAgICAgICAgLm1ha2VMb2dUeXBlV2l0aFByZWZpeCgnRXJyb3InKVxuICAgICAgICAubWFrZURhdGVGb3JtYXQobmV3IERhdGUoKSlcbiAgICAgICAgLm1ha2VNZXRob2QobWV0aG9kKVxuICAgICAgICAubWFrZVVybCh1cmwsIGJhc2VVUkwpXG4gICAgICAgIC5tYWtlUGFyYW1zKHBhcmFtcylcbiAgICAgICAgLm1ha2VTdGF0dXMoc3RhdHVzLCBzdGF0dXNUZXh0KVxuICAgICAgICAubWFrZUhlYWRlcihoZWFkZXJzKVxuICAgICAgICAubWFrZURhdGEoZGF0YSBhcyBvYmplY3QpIC8vIFRPRE86IGZpeCB0eXBlXG4gICAgICAgIC5idWlsZCgpO1xuXG4gICAgYnVpbGRDb25maWcubG9nZ2VyKGxvZyk7XG5cbiAgICByZXR1cm4gZXJyb3I7XG59XG5cbmZ1bmN0aW9uIGVycm9yTG9nZ2VyKGVycm9yOiBBeGlvc0Vycm9yLCBjb25maWc/OiBFcnJvckxvZ0NvbmZpZykge1xuICAgIHJldHVybiBQcm9taXNlLnJlamVjdDxBeGlvc0Vycm9yPihlcnJvckxvZ2dlcldpdGhvdXRQcm9taXNlKGVycm9yLCBjb25maWcpKTtcbn1cblxuZXhwb3J0IHsgZXJyb3JMb2dnZXIsIGVycm9yTG9nZ2VyV2l0aG91dFByb21pc2UgfTtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUVBLElBQUFBLE9BQUEsR0FBQUMsT0FBQTtBQUNBLElBQUFDLGNBQUEsR0FBQUMsc0JBQUEsQ0FBQUYsT0FBQTtBQUFxRCxTQUFBRSx1QkFBQUMsR0FBQSxXQUFBQSxHQUFBLElBQUFBLEdBQUEsQ0FBQUMsVUFBQSxHQUFBRCxHQUFBLEtBQUFFLE9BQUEsRUFBQUYsR0FBQTtBQUVyRCxTQUFTRyx5QkFBeUJBLENBQUNDLEtBQWlCLEVBQUVDLE1BQXNCLEdBQUcsQ0FBQyxDQUFDLEVBQUU7RUFDL0UsSUFBSSxDQUFDRCxLQUFLLENBQUNDLE1BQU0sRUFBRTtJQUNmLE9BQU9ELEtBQUs7RUFDaEI7RUFFQSxNQUFNO0lBQUNDLE1BQU0sRUFBRTtNQUFFQyxNQUFNO01BQUVDLE9BQU87TUFBRUMsTUFBTTtNQUFFQztJQUFJLENBQUM7SUFBRUM7RUFBUSxDQUFDLEdBQUdOLEtBQUs7RUFFbEUsSUFBSU8sTUFBTSxFQUFFQyxVQUFVLEVBQUVDLElBQUksRUFBRUMsT0FBTztFQUNyQyxJQUFJSixRQUFRLEVBQUU7SUFDVkMsTUFBTSxHQUFHRCxRQUFRLENBQUNDLE1BQU07SUFDeEJDLFVBQVUsR0FBR0YsUUFBUSxDQUFDRSxVQUFVO0lBQ2hDQyxJQUFJLEdBQUdILFFBQVEsQ0FBQ0csSUFBSTtJQUNwQkMsT0FBTyxHQUFHSixRQUFRLENBQUNJLE9BQU87RUFDOUI7RUFFQSxNQUFNQyxXQUFXLEdBQUcsSUFBQUMsMkJBQW1CLEVBQUNYLE1BQU0sQ0FBQztFQUUvQyxNQUFNWSxhQUFhLEdBQUcsSUFBSUMsc0JBQWEsQ0FBQ0gsV0FBVyxDQUFDO0VBQ3BELE1BQU1JLEdBQUcsR0FBR0YsYUFBYSxDQUNwQkcscUJBQXFCLENBQUMsT0FBTyxDQUFDLENBQzlCQyxjQUFjLENBQUMsSUFBSUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUMxQkMsVUFBVSxDQUFDakIsTUFBTSxDQUFDLENBQ2xCa0IsT0FBTyxDQUFDZixHQUFHLEVBQUVGLE9BQU8sQ0FBQyxDQUNyQmtCLFVBQVUsQ0FBQ2pCLE1BQU0sQ0FBQyxDQUNsQmtCLFVBQVUsQ0FBQ2YsTUFBTSxFQUFFQyxVQUFVLENBQUMsQ0FDOUJlLFVBQVUsQ0FBQ2IsT0FBTyxDQUFDLENBQ25CYyxRQUFRLENBQUNmLElBQWMsQ0FBQyxDQUFDO0VBQUEsQ0FDekJnQixLQUFLLENBQUMsQ0FBQztFQUVaZCxXQUFXLENBQUNlLE1BQU0sQ0FBQ1gsR0FBRyxDQUFDO0VBRXZCLE9BQU9mLEtBQUs7QUFDaEI7QUFFQSxTQUFTMkIsV0FBV0EsQ0FBQzNCLEtBQWlCLEVBQUVDLE1BQXVCLEVBQUU7RUFDN0QsT0FBTzJCLE9BQU8sQ0FBQ0MsTUFBTSxDQUFhOUIseUJBQXlCLENBQUNDLEtBQUssRUFBRUMsTUFBTSxDQUFDLENBQUM7QUFDL0UifQ==